<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKYvibe</title>
    {% load static %} <!-- Load the static tag -->
    <link rel="stylesheet" href="{% static 'welcomePage/css/homePage_css.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<style>

</style>

<body>
    <div class="banner">
        <!-- SKYvibe logo and welcome message -->
        <img src="{% static 'welcomePage/images/logo.png' %}" class="logo" alt="SKYvibe logo">
        <h2 id="welcome"> Your squad's health, reimagined.</h2>

        <!-- clouds animation -->
        <div class="clouds">
            <img src="{% static 'welcomePage/images/cloud1.png' %}" style="--i:1;">
            <img src="{% static 'welcomePage/images/cloud2.png' %}" style="--i:2;">
            <img src="{% static 'welcomePage/images/cloud3.png' %}" style="--i:3;">
            <img src="{% static 'welcomePage/images/cloud4.png' %}" style="--i:4;">
            <img src="{% static 'welcomePage/images/cloud5.png' %}" style="--i:5;">
            <img src="{% static 'welcomePage/images/cloud1.png' %}" style="--i:10;">
            <img src="{% static 'welcomePage/images/cloud2.png' %}" style="--i:9;">
            <img src="{% static 'welcomePage/images/cloud3.png' %}" style="--i:8;">
            <img src="{% static 'welcomePage/images/cloud4.png' %}" style="--i:7;">
            <img src="{% static 'welcomePage/images/cloud5.png' %}" style="--i:6;">
        </div>
    </div>

    <div class="content">
        <!-- Get Started / scroll to login -->
        <div class="scroll-down" onclick="scrollToLogin()">
            <img src="{% static 'welcomePage/images/arrow_up.png' %}" alt="scroll-down arrow">

            <div class="get-started">
                <h4>Get started</h4>
            </div>
        </div>

        <!-- Login Section -->
        <div class="login-section">
            <div class="login-card">

                <form id="loginForm">
                    
                    <!-- Login form -->
                    <input type="email" name="email" placeholder="Email" required id="email">


                    <div class="password-container">
                        <input type="password" name="password" placeholder="Password" required id="password">
                        <img src="{% static 'welcomePage/images/eye.png' %}" alt="Toggle password visibility"
                            class="toggle-password">
                    </div>

                    <!-- Remember me and forgot password -->
                    <label><input type="checkbox" name="remember_me" id="checkbox"> Remember Me</label>

                    <a href="#forgot-password hidden " class="forgot-password">Forgot Password?</a>

                    <!-- Login and Register buttons -->
                    <a href="{% url 'admin:index' %} ">
                        <button type="submit" class="login-btn">Login</button>
                    </a>

                    <p>Don't have an account? <a href="#register-card hidden" class="register-link">Register</a></p>

                    <!-- Admin button -->
                    <a href="{% url 'admin:index' %}">
                        <button type="button" class="admin-btn">Admin</button>
                    </a>

                </form>
            </div>

            <div class="forgot-password hidden" id="forgotPassword">
                <a class="back-login" href="javascript:void(0);" onclick="scrollToLogin()"> &#60; Back</a>

                <h4>Forgot Your Password</h4>
                <p>Please enter the email address you'd like your password reset information sent to.</p>

                <input type="email" placeholder="Email" required id="reg-email">

                <button type="submit" class="request-reset-btn">Request Reset Link</button>

            </div>

            <div class="reset-password hidden" id="resetPassword">
                <a class="back-forgot-password" href="javascript:void(0);" onclick="scrollToLogin()"> &#60; Back</a> <!-- Back to forgot password -->

                <h4>Reset Your Password</h4>
                <p>Enter a new password for </p>

                <input type="email" placeholder="Email" required id="reg-email">

                <button type="submit" class="request-reset-btn">Request Reset Link</button>

            </div>


            <!-- Register form (hidden as default, will become visible after user clicks "register") -->
            <div class="register-card hidden" id="registerForm">

                <form id="registerform"></form>
                <div class="button-container">
                    <button type="button" class="engineer-btn">Engineer</button>
                    <button type="button" class="management-btn">Management</button>
                </div>

                <a class="back-login" href="javascript:void(0);" onclick="scrollToLogin()"> &#60; Back</a>

                
                    <div class="name-container">
                        <input type="text" placeholder="First Name" required id="firstname">
                        <input type="text" placeholder="Last Name" required id="surname">
                    </div>

                    <input type="email" placeholder="Company email" required id="reg-email">


                    <div class="department-container">
                        <select class="form-control" id="Department" required>
                            <option value="department-AllDepartments">Select Department</option>
                            <option value="department-NetworkOps">Network Operations</option>
                            <option value="department-CloudInfrastructure">Cloud Infrastructure</option>
                            <option value="department-StreamingServices">Streaming Services</option>
                            <option value="department-DigitalMedia">Digital Media</option>
                            <option value="department-ContentDelivery">Content Delivery</option>
                            <option value="department-TVTechnology">TV Technology</option>
                            <option value="department-MobileDevelopment">Mobile Development</option>
                            <option value="department-AppInnovation">App Innovation</option>
                            <option value="department-UserExperience">User Experience</option>
                            <option value="department-AIandAutomation">AI & Automation</option>
                        </select>

                        <select class="form-control" id="Team" required>
                            <option value="team-AllTeams">Select Team</option>
                            <option value="team-AI">AI</option>
                            <option value="team-Analytics">Analytics</option>
                            <option value="team-Android">Android</option>
                            <option value="team-Kotlin">Kotlin</option>
                            <option value="team-Swift">Swift</option>
                            <option value="team-IoT">IoT</option>
                            <option value="team-SkyNet">SkyNet</option>
                            <option value="team-SkyVision">SkyVision</option>
                            <option value="team-HDStream">HDStream</option>
                            <option value="team-BroadcastOps">BroadcastOps</option>
                            <option value="team-SatelliteSync">SatelliteSync</option>
                            <option value="team-SkyBox">SkyBox</option>
                            <option value="team-UltraHD">UltraHD</option>
                            <option value="team-EntertainmentHub">Entertainment Hub</option>
                            <option value="team-SkyGo">SkyGo</option>
                            <option value="team-DigitalEdge">DigitalEdge</option>
                            <option value="team-UXPioneers">UX Pioneers</option>
                            <option value="team-AppVelocity">AppVelocity</option>
                            <option value="team-MobileStream">MobileStream</option>
                            <option value="team-CloudConnect">CloudConnect</option>
                            <option value="team-SkyFi">SkyFi</option>
                            <option value="team-CloudSync">CloudSync</option>
                            <option value="team-SkyMobile">SkyMobile</option>
                        </select>

                    </div>

                    <div class="password-container">
                        <input type="password" placeholder="Password" required id="reg-password">
                        <img src="{% static 'welcomePage/images/eye.png' %}" alt="Toggle password visibility"
                            class="toggle-password">
                    </div>
                    <p class="password-requirements">
                        Password should contain at least 8 characters, a mix of uppercase and lowercase letters, numbers
                        and special characters.
                    </p>
                    <div class="password-container">
                        <input type="password" placeholder="Confirm your Password" required id="confirm-password">
                        <img src="{% static 'welcomePage/images/eye.png' %}" alt="Toggle password visibility"
                            class="toggle-password">
                    </div>


                    <input type="checkbox" required id="checkbox"> I agree <a href="https://www.sky.com/help/articles/sky-terms-and-conditions" class="terms" target="skyTerms&Conditions" style="color: white">Terms & Conditions</a>
                    <button type="submit" class="register-btn">Register</button>
                </form>
            </div>

            <script>

                // Scroll to login function
                function scrollToLogin() {
                    document.querySelector('.login-section').scrollIntoView({ behavior: 'smooth' });
                }

                //password toggle
                document.querySelectorAll('.toggle-password').forEach(icon => {
                    icon.addEventListener('click', function () {
                        const passwordInput = this.previousElementSibling;
                        const isPassword = passwordInput.type === 'password';
                        passwordInput.type = isPassword ? 'text' : 'password';
                        this.classList.toggle('visible', isPassword);
                    });
                });

                // Team to Department mapping
                const teamToDepartment = {
                    'team-AI': 'department-AIandAutomation',
                    'team-Analytics': 'department-DigitalMedia',
                    'team-Android': 'department-MobileDevelopment',
                    'team-Kotlin': 'department-MobileDevelopment',
                    'team-Swift': 'department-MobileDevelopment',
                    'team-IoT': 'department-CloudInfrastructure',
                    'team-SkyNet': 'department-NetworkOps',
                    'team-SkyVision': 'department-ContentDelivery',
                    'team-HDStream': 'department-StreamingServices',
                    'team-BroadcastOps': 'department-NetworkOps',
                    'team-SatelliteSync': 'department-CloudInfrastructure',
                    'team-SkyBox': 'department-TVTechnology',
                    'team-UltraHD': 'department-TVTechnology',
                    'team-EntertainmentHub': 'department-DigitalMedia',
                    'team-SkyGo': 'department-StreamingServices',
                    'team-DigitalEdge': 'department-DigitalMedia',
                    'team-UXPioneers': 'department-UserExperience',
                    'team-AppVelocity': 'department-AppInnovation',
                    'team-MobileStream': 'department-MobileDevelopment',
                    'team-CloudConnect': 'department-CloudInfrastructure',
                    'team-SkyFi': 'department-CloudInfrastructure',
                    'team-CloudSync': 'department-CloudInfrastructure',
                    'team-SkyMobile': 'department-MobileDevelopment'


                };

                // Department to Team mapping
                const departmentToTeam = {
                    'department-AIandAutomation': ['team-AI'],
                    'department-DigitalMedia': ['team-Analytics', 'team-EntertainmentHub', 'team-DigitalEdge'],
                    'department-MobileDevelopment': ['team-Android', 'team-Kotlin', 'team-Swift', 'team-MobileStream', 'team-SkyMobile'],
                    'department-CloudInfrastructure': ['team-IoT', 'team-SatelliteSync', 'team-CloudConnect', 'team-SkyFi', 'team-CloudSync'],
                    'department-NetworkOps': ['team-SkyNet', 'team-BroadcastOps'],
                    'department-ContentDelivery': ['team-SkyVision'],
                    'department-StreamingServices': ['team-HDStream', 'team-SkyGo'],
                    'department-TVTechnology': ['team-SkyBox', 'team-UltraHD'],
                    'department-UserExperience': ['team-UXPioneers'],
                    'department-AppInnovation': ['team-AppVelocity'],

                };

                const teamSelect = document.getElementById('Team');
                const deptSelect = document.getElementById('Department');
                const engineerBtn = document.querySelector('.engineer-btn');
                const managementBtn = document.querySelector('.management-btn');

                // Store initial options for resetting
                const allTeams = Array.from(teamSelect.options).map(opt => ({
                    value: opt.value,
                    text: opt.text
                }));
                const allDepartments = Array.from(deptSelect.options).map(opt => ({
                    value: opt.value,
                    text: opt.text
                }));

                // Populate team dropdown with specific teams or all teams
                function populateTeams(teamList = allTeams.slice(1)) { // Skip "Select Team"
                    teamSelect.innerHTML = '<option value="team-AllTeams" disabled selected >Select Team</option>';
                    teamList.forEach(team => {
                        const option = document.createElement('option');
                        option.value = team.value;
                        option.text = team.text;
                        teamSelect.appendChild(option);
                    });
                }

                // Populate department dropdown with all departments
                function populateDepartments() {
                    deptSelect.innerHTML = '<option value="department-AllDepartments" disabled selected >Select Department</option>';
                    allDepartments.slice(1).forEach(dept => {
                        const option = document.createElement('option');
                        option.value = dept.value;
                        option.text = dept.text;
                        deptSelect.appendChild(option);
                    });
                }

                //Event listener for team selection
                teamSelect.addEventListener('change', function () {
                    const selectedTeam = this.value;
                    if (selectedTeam === 'team-AllTeams') {
                        // Reset both team and department to initial state
                        populateDepartments();
                        populateTeams();
                        deptSelect.value = 'department-AllDepartments';
                    } else if (selectedTeam === 'N/A') {
                        // Allow any department to be selected when team is "N/A"
                        populateDepartments();
                        // Add "N/A" to deptSelect if in management mode
                        if (isManagementMode && !Array.from(deptSelect.options).some(opt => opt.value === 'N/A')) {
                            const deptOption = document.createElement('option');
                            deptOption.value = 'N/A';
                            deptOption.text = 'N/A';
                            deptSelect.appendChild(deptOption);
                        }
                        deptSelect.value = 'department-AllDepartments';
                    } else if (teamToDepartment[selectedTeam]) {
                        const relatedDept = teamToDepartment[selectedTeam];
                        deptSelect.value = relatedDept; // Auto-select related department
                    }
                    // Ensure teamSelect stays "N/A" if deptSelect is "N/A"
                    if (deptSelect.value === 'N/A' && teamSelect.value !== 'N/A') {
                        teamSelect.innerHTML = '<option value="N/A" selected>N/A</option>';
                    }
                });

                // Event listener for department selection
                deptSelect.addEventListener('change', function () {
                    const selectedDept = this.value;
                    if (selectedDept === 'department-AllDepartments') {
                        populateTeams();
                        teamSelect.value = 'team-AllTeams';
                    } else {
                        updateTeamSelect(deptSelect, teamSelect);
                    }
                });

                // Initial setup
                populateTeams();
                populateDepartments();

                // Register form toggle
                const registerForm = document.getElementById('registerForm');
                const registerLink = document.querySelector('.register-link');
                const backLogin = document.querySelector('.back-login');
                const loginCard = document.querySelector('.login-card');

                // Show the register form when the "Register" link is clicked
                registerLink.addEventListener('click', function (e) {
                    e.preventDefault(); // Prevent default link behavior
                    loginCard.classList.add('hidden'); // Hide the login form
                    registerForm.classList.remove('hidden'); // Show the register form
                });

                // Show the login form when the "Back" link is clicked
                backLogin.addEventListener('click', function (e) {
                    e.preventDefault(); // Prevent default link behavior
                    registerForm.classList.add('hidden'); // Hide the register form
                    loginCard.classList.remove('hidden'); // Show the login form
                });

                // Management team/department selection
                function setManagementMode() {
                    isManagementMode = true;

                    if (!Array.from(deptSelect.options).some(option => option.value === 'N/A')) {
                        const deptOption = document.createElement('option');
                        deptOption.value = 'N/A';
                        deptOption.text = 'N/A';
                        deptSelect.appendChild(deptOption);
                    }


                    deptSelect.value = 'N/A';
                    updateTeamSelect(deptSelect, teamSelect);

                    engineerBtn.classList.remove('active'); // Highlight Engineer button
                    managementBtn.classList.add('active'); // Remove highlight from Management button


                }

                function updateTeamSelect(deptSelect, teamSelect) {
                    const currentTeam = teamSelect.value; // Preserve current team selection
                    if (deptSelect.value === 'N/A') {
                        // When dept is "N/A", teamSelect should only have "N/A"
                        teamSelect.innerHTML = '<option value="N/A" selected>N/A</option>';
                    } else if (isManagementMode) {
                        // After management button is clicked, include "N/A" and related teams for the department
                        const relatedTeams = departmentToTeam[deptSelect.value] || [];
                        teamSelect.innerHTML = '<option value="team-AllTeams" disabled selected>Select Team</option>';
                        // Always include "N/A"
                        const naOption = document.createElement('option');
                        naOption.value = 'N/A';
                        naOption.text = 'N/A';
                        teamSelect.appendChild(naOption);
                        // Add related teams
                        relatedTeams.forEach(teamValue => {
                            const team = allTeams.find(t => t.value === teamValue);
                            if (team) {
                                const option = document.createElement('option');
                                option.value = team.value;
                                option.text = team.text;
                                teamSelect.appendChild(option);
                            }
                        });
                        // Restore previous selection if it still exists, else default to "team-AllTeams"
                        teamSelect.value = Array.from(teamSelect.options).some(opt => opt.value === currentTeam) ? currentTeam : 'team-AllTeams';
                    }
                }
                // Set dropdowns to Engineer mode
                function setEngineerMode() {
                    populateDepartments();
                    populateTeams();
                    deptSelect.disabled = false;
                    teamSelect.disabled = false;
                    isManagementMode = false; // Reset management mode

                    engineerBtn.classList.add('active'); // Highlight Engineer button
                    managementBtn.classList.remove('active'); // Remove highlight from Management button

                }

                engineerBtn.addEventListener('click', function () {
                    setEngineerMode();
                });

                // Event listener for Management button
                managementBtn.addEventListener('click', function () {
                    setManagementMode();
                });

                setEngineerMode();



            </script>
</body>

</html>